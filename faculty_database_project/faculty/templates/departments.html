{% extends 'base.html' %}

<meta charset="UTF-8">

{% block title %}Список кафедр{% endblock %}

{% block content %}
    <h1>Список кафедр</h1>

    <p class="count">Количество кафедр: {{ count }}</p>

    <!-- Кнопка для добавления кафедры -->
    <a href="{% url 'department_add' %}" class="btn btn-custom">Добавить кафедру</a>

    <!-- Таблица кафедр -->
    <table class="table table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Название кафедры</th>
                <th>Сокращённое название</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for department in page_departments %}
                <tr>
                    <td>{{ department.department_id }}</td>
                    <td>{{ department.department_name }}</td>
                    <td>{{ department.department_name_short }}</td>
                    <td>
                        <div class="buttons-container">
                            <a href="{% url 'department_change' department.department_id %}" class="btn btn-custom">Изменить</a>
                            <form action="{% url 'department_delete' department.department_id %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-custom">Удалить</button>
                            </form>
                        </div>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="4">Кафедры не найдены</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

<!-- Pagination buttons -->
<div class="pagination">
    <span class="step-links">
        {% if page_departments.has_previous %}
            <a href="?page=1"><button class="btn btn-custom">&laquo; Первая</button></a>
            <a href="?page={{ page_departments.previous_page_number }}"><button class="btn btn-custom">Предыдущая</button></a>
        {% endif %}

        {% for num in page_departments.paginator.page_range %}
            {% if page_departments.number == num %}
                <button class="btn btn-current">{{ num }}</button>
            {% elif num > page_departments.number|add:'-6' and num < page_departments.number|add:'6' %}
                <a href="?page={{ num }}"><button class="btn btn-custom">{{ num }}</button></a>
            {% elif num == 1 or num == page_departments.paginator.num_pages %}
                <a href="?page={{ num }}"><button class="btn btn-custom">{{ num }}</button></a>
            {% elif num == page_departments.number|add:'-6' or num == page_departments.number|add:'6' %}
                <span>...</span>
            {% endif %}
        {% endfor %}

        {% if page_departments.has_next %}
            <a href="?page={{ page_departments.next_page_number }}"><button class="btn btn-custom">Следующая</button></a>
            <a href="?page={{ page_departments.paginator.num_pages }}"><button class="btn btn-custom">Последняя &raquo;</button></a>
        {% endif %}
    </span>
</div>

{% endblock %}
