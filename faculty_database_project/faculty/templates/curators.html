{% extends 'base.html' %}

<meta charset="UTF-8">

{% block title %}Список кураторов{% endblock %}

{% block content %}
<h1>Список кураторов</h1>

<p class="count">Количество кураторов: {{ count }}</p>

<!-- Кнопка для добавления куратора -->
<a href="{% url 'curator_add' %}" class="btn btn-custom">Добавить куратора</a>

<p><button style="margin-top: 20px;" class="btn btn-custom" onclick="toggleSearch()">Поиск</button></p>
<div id="searchForm" style="display: none;">
    <form action="{% url 'curator_search' %}" method="post" novalidate>
        {% csrf_token %}
        <div class="form-group">
                <label for="curator_id">Id куратора:</label>
                <input type="text" class="form-control" id="curator_id" name="curator_id" placeholder="Введите id" required oninput="checkPositiveInteger(this)">
            </div>
    <div class="form-group">
        <label for="curatorSecondName">Фамилия куратора:</label>
        <input type="text" class="form-control" id="curatorSecondName" name="curator_second_name"
               placeholder="Введите фамилию куратора" required oninput="checkInput(this)">
    </div>
    <div class="form-group">
        <label for="curatorFirstName">Имя куратора:</label>
        <input type="text" class="form-control" id="curatorFirstName" name="curator_first_name"
               placeholder="Введите имя куратора" required oninput="checkInput(this)">
    </div>
    <div class="form-group">
        <label for="curatorMiddleName">Отчество куратора:</label>
        <input type="text" class="form-control" id="curatorMiddleName" name="curator_middle_name"
               placeholder="Введите отчество куратора при наличии" required oninput="checkInput(this)">
           <label for="search_by_middle_name">Искать по отчеству</label>
    <input type="checkbox" id="search_by_middle_name" name="search_by_middle_name" value="yes">
    </div>
    <div class="form-group">
        <label for="curatorContactNumber">Номер телефона куратора:</label>
        <input type="text" class="form-control" id="curatorContactNumber" name="curator_contact_number"
               placeholder="Введите номер телефона куратора" required oninput="checkPhoneNumber(this)">
    </div>
            <button type="submit" class="btn btn-custom">Найти</button>
    </form>
</div>

<!-- Таблица кураторов -->
<table class="table table-hover">
    <thead>
    <tr>
        <th>ID</th>
        <th>Фамилия</th>
        <th>Имя</th>
        <th>Отчество</th>
        <th>Контактный номер</th>
        <th>Действия</th>
    </tr>
    </thead>
    <tbody>
    {% for curator in page_curators %}
    <tr>
        <td>{{ curator.curator_id }}</td>
        <td>{{ curator.curator_second_name }}</td>
        <td>{{ curator.curator_first_name }}</td>
        <td> {{ curator.curator_middle_name|default_if_none:'' }}
        </td>
        <td>{{ curator.curator_contact_number }}</td>
        <td>
            <div class="buttons-container">
                <a href="{% url 'curator_change' curator.curator_id %}" class="btn btn-custom">Изменить</a>
                <form action="{% url 'curator_delete' curator.curator_id %}" method="post" style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-custom"
                            onclick="return confirm('Вы уверены, что хотите удалить этого куратора?');">Удалить
                    </button>
                </form>
            </div>
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="6">Кураторы не найдены</td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<!-- Pagination buttons -->
<div class="pagination">
    <span class="step-links">
        {% if page_curators.has_previous %}
            <a href="?page=1"><button class="btn btn-custom">&laquo; Первая</button></a>
            <a href="?page={{ page_curators.previous_page_number }}"><button class="btn btn-custom">Предыдущая</button></a>
        {% endif %}

        {% for num in page_curators.paginator.page_range %}
            {% if page_curators.number == num %}
                <button class="btn btn-current">{{ num }}</button>
            {% elif num > page_curators.number|add:'-6' and num < page_curators.number|add:'6' %}
                <a href="?page={{ num }}"><button class="btn btn-custom">{{ num }}</button></a>
            {% elif num == 1 or num == page_curators.paginator.num_pages %}
                <a href="?page={{ num }}"><button class="btn btn-custom">{{ num }}</button></a>
            {% elif num == page_curators.number|add:'-6' or num == page_curators.number|add:'6' %}
                <span>...</span>
            {% endif %}
        {% endfor %}

        {% if page_curators.has_next %}
            <a href="?page={{ page_curators.next_page_number }}"><button class="btn btn-custom">Следующая</button></a>
            <a href="?page={{ page_curators.paginator.num_pages }}"><button
                    class="btn btn-custom">Последняя &raquo;</button></a>
        {% endif %}
    </span>
</div>

{% endblock %}
