{% extends 'base.html' %}

<meta charset="UTF-8">

{% block title %}Список направлений{% endblock %}

{% block content %}
<h1>Список направлений</h1>

<p class="count">Количество направлений: {{ count }}</p>

<!-- Кнопка для добавления направления -->
<a href="{% url 'direction_add' %}" class="btn btn-custom">Добавить направление</a>

<p ><button style="margin-top: 20px;" class="btn btn-custom" onclick="toggleSearch()">Поиск</button></p>
<div id="searchForm" style="display: none;">
    <form action="{% url 'direction_search' %}" method="post" novalidate>
        {% csrf_token %}
        <div class="form-group">
            <label for="direction_id">Id направления:</label>
            <input type="text" class="form-control" id="direction_id" name="direction_id" placeholder="Введите id" required oninput="checkPositiveInteger(this)">
        </div>
    <div class="form-group">
        <label for="directionName">Название направления:</label>
        <input type="text" class="form-control" id="directionName" name="direction_name"
               placeholder="Введите название направления" required oninput="checkInput(this)">
    </div>
     <div class="form-group">
        <label for="specialization">Специализация:</label>
        <input type="text" class="form-control" id="specialization" name="specialization" placeholder="Введите специализацию">
          <label for="search_by_specialization">Искать по специализации:</label>
    <input type="checkbox" id="search_by_specialization" name="search_by_specialization" value="yes">
    </div>

    <div class="form-group">
        <label for="department">Кафедра:</label>
        <select class="form-control" id="department" name="department" required>
            <option value="">Выберите кафедру</option>
            {% for department in departments %}
            <option value="{{ department.department_id }}"> {{ department.department_name }} </option>
            {% endfor %}
        </select>
    </div>
        <button type="submit" class="btn btn-custom">Найти</button>

    </form>
</div>

<!-- Таблица направлений -->
<table class="table table-hover">
    <thead>
    <tr>
        <th>ID</th>
        <th>Название направления</th>
        <th>Специализация</th>
        <th>Кафедра</th>
        <th>Действия</th>
    </tr>
    </thead>
    <tbody>
    {% for direction in page_direction %}
    <tr>
        <td>{{ direction.direction_id }}</td>
        <td>{{ direction.direction_name }}</td>
        <td>{% if direction.specialization %}
            {{ direction.specialization }}
            {% else %}
            Отсутствует
            {% endif %}
        </td>
        <td>{{ direction.department.department_name }}</td>
        <td>
            <div class="buttons-container">
                <a href="{% url 'direction_change' direction.direction_id %}" class="btn btn-custom">Изменить</a>
                <form action="{% url 'direction_delete' direction.direction_id %}" method="post"
                      style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-custom"
                            onclick="return confirm('Вы уверены, что хотите удалить это направление?');">Удалить
                    </button>
                </form>
            </div>
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="5">Направления не найдены</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
<div class="pagination">
    <span class="step-links">
        {% if page_direction.has_previous %}
            <a href="?page=1"><button class="btn btn-custom">&laquo; Первая</button></a>
            <a href="?page={{ page_direction.previous_page_number }}"><button class="btn btn-custom">Предыдущая</button></a>
        {% endif %}

        {% for num in page_direction.paginator.page_range %}
            {% if page_direction.number == num %}
                <button class="btn btn-current">{{ num }}</button>
            {% elif num > page_direction.number|add:'-6' and num < page_direction.number|add:'6' %}
                <a href="?page={{ num }}"><button class="btn btn-custom">{{ num }}</button></a>
            {% elif num == 1 or num == page_direction.paginator.num_pages %}
                <a href="?page={{ num }}"><button class="btn btn-custom">{{ num }}</button></a>
            {% elif num == page_direction.number|add:'-6' or num == page_direction.number|add:'6' %}
                <span>...</span>
            {% endif %}
        {% endfor %}

        {% if page_direction.has_next %}
            <a href="?page={{ page_direction.next_page_number }}"><button class="btn btn-custom">Следующая</button></a>
            <a href="?page={{ page_direction.paginator.num_pages }}"><button
                    class="btn btn-custom">Последняя &raquo;</button></a>
        {% endif %}
    </span>
</div>
{% endblock %}
